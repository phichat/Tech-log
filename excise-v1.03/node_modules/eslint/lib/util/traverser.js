/**
 * @fileoverview Wrapper around estraverse
 * @author Nicholas C. Zakas
 */
"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

const estraverse = require("estraverse");

//------------------------------------------------------------------------------
// Helpers
//------------------------------------------------------------------------------

<<<<<<< HEAD
const KEY_BLACKLIST = [
    "parent",
    "leadingComments",
    "trailingComments"
];
=======
const KEY_BLACKLIST = new Set([
    "parent",
    "leadingComments",
    "trailingComments"
]);
>>>>>>> 09665636ba9818fc952cd8bfe693d791912356d2

/**
 * Wrapper around an estraverse controller that ensures the correct keys
 * are visited.
 * @constructor
 */
<<<<<<< HEAD
function Traverser() {

    const controller = Object.create(new estraverse.Controller()),
        originalTraverse = controller.traverse;

    // intercept call to traverse() and add the fallback key to the visitor
    controller.traverse = function(node, visitor) {
        visitor.fallback = Traverser.getKeys;
        return originalTraverse.call(this, node, visitor);
    };

    return controller;
}

/**
 * Calculates the keys to use for traversal.
 * @param {ASTNode} node The node to read keys from.
 * @returns {string[]} An array of keys to visit on the node.
 * @private
 */
Traverser.getKeys = function(node) {
    return Object.keys(node).filter(key => KEY_BLACKLIST.indexOf(key) === -1);
};

module.exports = Traverser;


=======
class Traverser extends estraverse.Controller {
    traverse(node, visitor) {
        visitor.fallback = Traverser.getKeys;
        return super.traverse(node, visitor);
    }

    /**
     * Calculates the keys to use for traversal.
     * @param {ASTNode} node The node to read keys from.
     * @returns {string[]} An array of keys to visit on the node.
     * @private
     */
    static getKeys(node) {
        return Object.keys(node).filter(key => !KEY_BLACKLIST.has(key));
    }
}

module.exports = Traverser;
>>>>>>> 09665636ba9818fc952cd8bfe693d791912356d2
